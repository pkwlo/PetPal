<!DOCTYPE html>
<html>

<head>
    <title>Reminders</title>
    <link rel="stylesheet" href="/css/style.css">
    <script>
        // Fetch user info and populate the page
        function fetchUserInfo() {
            fetch('/profile/user-info')
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        alert(data.error);
                        window.location.href = '/login';
                    } else {
                        // Populate user info
                        document.getElementById('name').innerText = data.name;
                        document.getElementById('userId').value = data.sub;
                        console.log(data.name)
                        console.log(data.sub)
                    }
                });
        }
        
        // Fetch upcoming events and populate the page
        function fetchUpcomingEvents() {
            fetch('/reminders/upcoming')
                .then(response => response.json())
                .then(data => {
                    const eventsContainer = document.querySelector('.events');
                    eventsContainer.innerHTML = '';
                    data.forEach(event => {
                        const eventElement = document.createElement('div');
                        eventElement.classList.add('event');
                        eventElement.innerHTML = `
                            <h2>${event.reminderType}</h2>
                            <p><strong>Date:</strong> ${event.reminderDate}</p>
                            <p><strong>Time:</strong> ${event.reminderTime}</p>
                            <p><strong>Description:</strong> ${event.reminderDescription}</p>
                        `;
                        eventsContainer.appendChild(eventElement);
                    });
                });
        }

        // Run the fetch when the page loads
        window.onload = fetchUserInfo;
        window.onload = fetchUpcomingEvents;
    </script>
</head>

<body>
    <!-- Navigation Bar -->
    <nav>
        <a href="/profile">Profile</a>
        <a href="/community">Community</a>
        <a href="/reminders">Reminders</a>
        <a href="/logout">Logout</a>
    </nav>
    <h1>Set a Reminder for <span id="userId"></span></h1>
    <form method="POST" action="/reminders/submit">
        <p>Reminder Type: <input name="reminderType"></p>
        <p>Reminder Date: <input type="date" name="reminderDate"></p>
        <p>Reminder Time: <input type="time" name="reminderTime"></p>
        <p>Reminder Description: <input name="reminderDescription"></p>
        <input type="hidden" name="userId" id="userId">
        <button type="submit">Set Reminder</button>
    </form>
    <h1>Upcoming Events</h1>
    <div class="events">
        <!-- events loading here -->
    </div>
</body>

</html>

